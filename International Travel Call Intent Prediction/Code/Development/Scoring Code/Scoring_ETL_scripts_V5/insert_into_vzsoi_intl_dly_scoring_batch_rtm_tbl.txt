set hive.exec.dynamic.partition.mode=nonstrict;
set hive.exec.dynamic.partition=true;

INSERT INTO VZW_SOI_PRD_TBLS.vzsoi_intl_dly_scoring_batch_rtm_tbl partition (process_dt)
SELECT DISTINCT 
A.CUST_ID,
A.ACCT_NUM ,
A.MTN , 
A.CUST_LINE_SEQ_ID,
A.ETHNICITY, 
A.AGE, 
A.CUST_ESTB_DT , 
A.PPLAN_EFF_DT , 
A.LINE_ACT_DT , 
A.MTN_ACT_DT , 
A.LINE_TERM_DT , 
A.CNTRCT_TERM_DT, 
A.BIRTH_YEAR , 
A.PPLAN_CD , 
A.PPLAN_TYPE_CD , 
A.PPLAN_DESC , 
A.ACCESS_AMT , 
A.DATA_ACCESS_AMT , 
A.ANLG_DGTL_IND , 
A.CNTRCT_TERM_IND , 
A.PREPAID_IND , 
A.PPLAN_BNDL_TYPE_CD , 
A.BI_PPLAN_DESC , 
A.BI_PPLAN_DESC_ABBRV , 
A.BI_PPLAN_SERVICE_TYPE_DESC , 
A.BI_PPLAN_TYPE_DESC , 
A.BI_PPLAN_CTGRY_DESC , 
A.BI_DATA_ALLOW_TIER_VALUE , 
A.BI_DATA_ALLOW_TIER_UNIT_MEAS , 
A.BI_RPT_PPLAN_DESC , 
A.MSG_ALLOW_SHARE_IND, 
A.DATA_ALLOW_SHARE_IND , 
A.VOICE_ALLOW_SHARE_IND , 
A.ACTIVITY_CD , 
A.svc_prod_id1 , 
A.svc_prod_desc1 , 
A.SVC_PROD_ID2 , 
A.SVC_PROD_DESC2 ,
A.SVC_PROD_ID3 , 
A.SVC_PROD_DESC3 ,
A.mtrans_ts1,
A.mtrans_ts2,
A.mtrans_ts3,
A.TP_TYPE1,
A.TP_TYPE2,
A.TP_TYPE3,
A.svc_prod_chrg_amt1 , 
A.svc_prod_treat_cd1 , 
A.max_svc_prod_eff_dt1,
A.FREE_PLAN, 
A.line_type, 
A.age_group, 
A.prod_nm, 
A.device_prod_nm, 
A.device_type_cd, 
A.device_brand_nm, 
A.DEVICE_TYPE,
A.device_compat, 
A.byod_flag, 
A.vz_device, 
A.tvl_pass_included, 
A.can_mex_free_plan, 
A.region_desc, 
A.adults_in_hshld, 
A.marital_status, 
A.child_in_hshld, 
A.gender_input, 
A.presence_young_adult, 
A.presence_sr_adult, 
A.internet_user_ind, 
A.hshld_size, 
A.religious_desc, 
A.bill_cycle_dt, 
A.pymnt_due_dt, 
A.feat_amt, 
A.prev_due_amt, 
A.pymnt_recvd_amt, 
A.pymnt_revrs_amt, 
A.bill_bal_amt, 
A.late_pymnt_chrg_amt, 
A.occ_amt, 
A.bill_curr_amt, 
A.bill_tot_amt, 
A.bill_30_day_amt, 
A.bill_90_day_amt, 
A.bill_180_day_amt, 
A.bill_cycle_ind, 
A.bill_6_mth_avg, 
A.occ_cdv, 
A.occ_amtv, 
A.occ_type_cdv, 
A.occ_desc_ref,
a.occ_reasons, 
A.trans_dt, 
A.agg_occ_value, 
A.cyc_mth_yr,
A.prev_bill_cycle_dt,
A.prev_pymnt_due_dt ,
A.prev_feat_amt ,
A.prev_prev_due_amt ,
A.prev_pymnt_recvd_amt ,
A.prev_pymnt_revrs_amt ,
A.prev_bill_bal_amt ,
A.prev_late_pymnt_chrg_amt ,
A.prev_occ_amt ,
A.prev_bill_curr_amt ,
A.prev_bill_tot_amt ,
A.prev_bill_30_day_amt ,
A.prev_bill_90_day_amt ,
A.prev_bill_180_day_amt ,
A.prev_bill_cycle_ind ,
A.prev_bill_6_mth_avg ,
A.prev_occ_cdv ,
A.prev_occ_amtv ,
A.prev_occ_type_cdv ,
A.prev_occ_desc ,
A.prev_trans_dt ,
A.prev_agg_occ_value ,
A.prev_cyc_mth_yr ,
A.total_data_allow, 
A.plan_data_allow, 
A.bonus_data_allow, 
A.sls_outlet_id, 
A.tenure, 
A.true_plan_data_allow, 
A.true_bonus_data_allow, 
A.gift_data_allow, 
A.true_total_data_allow, 
A.over_used, 
A.avgg, 
A.thsld, 
A.data_threshold, 
A.TVL1 ,
A.TVL2 ,
A.TVL3 ,
A.TVL4,
A.TVL5,
A.TVL6 ,
A.TVL7 ,
A.TVL8 ,
A.TVL9,
A.TVL10,
A.CCD1,
A.CCD2,
A.CCD3,
A.CCD4,
A.CCD5 , 
A.CCD6,
A.CCD7,
A.CCD8,
A.CCD9,
A.CCD10 , 
A.CALL_TS1,  
A.CALL_TS2 ,
A. CALL_TS3, 
A.CALL_TS4 ,
A.CALL_TS5,
A.CALL_TS6,
A.CALL_TS7, 
A. CALL_TS8,
A.CALL_TS9,
A.CALL_TS10 , 
A.IVR_CALL_ID1,
A.IVR_CALL_ID2,
A.IVR_CALL_ID3,
A.IVR_CALL_ID4,
A.IVR_CALL_ID5,
A.IVR_CALL_ID6, 
A.IVR_CALL_ID7,
A.IVR_CALL_ID8,
A.IVR_CALL_ID9,
A.IVR_CALL_ID10, 
A.COUNTRY_CD_COMBO,
A.PREV_TVL_COUNT,
A.PREV_CALL_COUNT,
A.MSG_DATE,
A.MSG_TIMESTAMP,
A.TOPIC,
A.ALERT_TYPE
,A.Primary1_topic
,A.secondary1_topic
,A.Primary2_topic
,A.secondary2_topic
,A.Primary3_topic
,A.secondary3_topic
,A.Primary4_topic
,A.secondary4_topic
,A.Primary5_topic
,A.secondary5_topic
,A.Primary6_topic
,A.secondary6_topic
,A.Primary7_topic
,A.secondary7_topic
,A.Primary8_topic
,A.secondary8_topic
,A.Primary9_topic
,A.secondary9_topic
,A.Primary10_topic
,A.secondary10_topic,
C.mvo_activate_tp_ind ,
C.mvo_intl_billing_ind ,	
C.mvo_tripplanner_ind ,	
C.mvo_cruise_ind ,
C.mvo_tp_video_ind ,	
C.mvo_usage_ind ,	
C.mvo_faq_international_ind ,	
C.mvo_device_support_ind ,
C.mvo_faq_general_ind ,
C.mvo_faq_outsideus_ind ,	
C.mvo_tp_page_chat_tp_ind ,	
C.mvo_settings_ind ,	
C.mvo_can_mex_ind ,	
C.mvo_unlimitedplans_ind ,	
C.mvo_tp_enquiry_ind ,
C.mvo_last_session_time ,
D.mva_activate_tp_ind ,
D.mva_intl_billing_ind ,	
D.mva_cruise_ind ,
D.mva_usage_ind ,	
D.mva_device_support_ind ,	
D.mva_tp_page_chat_tp_ind ,	
D.mva_can_mex_ind ,
D.mva_tp_enquiry_ind ,	
D.mva_countries_ind ,	
D.mva_disable_tp_ind ,	
D.mva_devices_ind ,
D.mva_last_pg_vst_time as mva_last_session_time,	
current_date() as process_dt
FROM (select DISTINCT * from VZW_SOI_PRD_TBLS.ITP_INTER_DLY_called_FINAL)  AS A
LEFT OUTER JOIN 
(SELECT DISTINCT * FROM VZW_SOI_PRD_TBLS.ITP_SAD_DLY_SCCAT_CALL_TVL_INDICATORS) AS C
ON A.CUST_ID=C.CUST_ID
AND A.MTN=C.MTN
LEFT OUTER JOIN 
(SELECT DISTINCT * FROM VZW_SOI_PRD_TBLS.ITP_SAD_DLY_MFAPP_CALL_TVL_INDICATORS) AS D
ON A.CUST_ID=D.CUST_ID
AND A.MTN=D.MTN;
