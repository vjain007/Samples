set hive.exec.dynamic.partition=true;
CREATE EXTERNAL TABLE VZW_SOI_PRD_TBLS.vzsoi_intl_call_base_tbl_v5
(
cust_id string,
acct_num string,
mtn string,
ivr_call_id string,
call_start_tm_stmp string,
cust_line_seq_id string,
ethnicity string,
age int,
cust_estb_dt date,
pplan_eff_dt date,
line_act_dt date,
mtn_act_dt date,
line_term_dt date,
cntrct_term_dt date,
birth_year int,
pplan_cd varchar(20),
pplan_type_cd char(5),
pplan_desc varchar(75),
access_amt decimal(10,2),
data_access_amt decimal(10,2),
anlg_dgtl_ind char(1),
cntrct_term_ind tinyint,
prepaid_ind char(1),
pplan_bndl_type_cd char(2),
bi_pplan_desc varchar(150),
bi_pplan_desc_abbrv varchar(32),
bi_pplan_service_type_desc varchar(150),
bi_pplan_type_desc varchar(150),
bi_pplan_ctgry_desc varchar(150),
bi_data_allow_tier_value decimal(10,0),
bi_data_allow_tier_unit_meas varchar(5),
bi_rpt_pplan_desc varchar(50),
msg_allow_share_ind char(1),
data_allow_share_ind char(1),
voice_allow_share_ind char(1),
activity_cd string,
svc_prod_id1 string,
svc_prod_desc1 string,
SVC_PROD_ID2 string, 
SVC_PROD_DESC2 string,
SVC_PROD_ID3 string, 
SVC_PROD_DESC3 string,
mtrans_ts1 string,
mtrans_ts2 string,
mtrans_ts3 string,
TP_TYPE1 string,
TP_TYPE2 string,
TP_TYPE3 string,
svc_prod_chrg_amt1 decimal(9,2),
svc_prod_treat_cd1 char(5),
max_svc_prod_eff_dt1 date,
free_plan string,
line_type string,
age_group string,
prod_nm char(32),
device_prod_nm char(32),
device_type_cd char(3),
device_brand_nm string,
DEVICE_TYPE string,
device_compat string,
byod_flag string,
vz_device string,
tvl_pass_included string,
can_mex_free_plan string,
region_desc string,
adults_in_hshld string,
marital_status string,
child_in_hshld string,
gender_input string,
presence_young_adult string,
presence_sr_adult string,
internet_user_ind string,
hshld_size string,
religious_desc string,
bill_cycle_dt string,
pymnt_due_dt date,
feat_amt decimal(15,2),
prev_due_amt decimal(15,2),
pymnt_recvd_amt decimal(15,2),
pymnt_revrs_amt decimal(15,2),
bill_bal_amt decimal(15,2),
late_pymnt_chrg_amt decimal(15,2),
occ_amt decimal(15,2),
bill_curr_amt decimal(15,2),
bill_tot_amt decimal(15,2),
bill_30_day_amt decimal(15,2),
bill_90_day_amt decimal(15,2),
bill_180_day_amt decimal(15,2),
bill_cycle_ind string,
bill_6_mth_avg decimal(19,6),
occ_cdv string,
occ_amtv string,
occ_type_cdv string,
occ_desc string,
occ_reasons string,
trans_dt string,
agg_occ_value decimal(25,2),
cyc_mth_yr string,
prev_bill_cycle_dt string,
prev_pymnt_due_dt date ,
prev_feat_amt decimal(15,2),
prev_prev_due_amt decimal(15,2),
prev_pymnt_recvd_amt decimal(15,2),
prev_pymnt_revrs_amt decimal(15,2),
prev_bill_bal_amt decimal(15,2),
prev_late_pymnt_chrg_amt decimal(15,2),
prev_occ_amt decimal(15,2),
prev_bill_curr_amt decimal(15,2),
prev_bill_tot_amt decimal(15,2),
prev_bill_30_day_amt decimal(15,2),
prev_bill_90_day_amt decimal(15,2),
prev_bill_180_day_amt decimal(15,2),
prev_bill_cycle_ind string,
prev_bill_6_mth_avg decimal(19,6),
prev_occ_cdv string,
prev_occ_amtv string,
prev_occ_type_cdv string,
prev_occ_desc string,
prev_trans_dt string,
prev_agg_occ_value decimal(25,2),
prev_cyc_mth_yr string, 
total_data_allow varchar(26),
plan_data_allow varchar(26),
bonus_data_allow varchar(26),
sls_outlet_id varchar(10),
tenure char(12),
true_plan_data_allow varchar(26),
true_bonus_data_allow varchar(26),
gift_data_allow varchar(26),
true_total_data_allow varchar(26),
over_used string,
avgg int,
thsld int,
data_threshold string,
tvl1 string,
tvl2 string,
tvl3 string,
tvl4 string,
tvl5 string,
tvl6 string,
tvl7 string,
tvl8 string,
tvl9 string,
tvl10 string,
ccd1 string,
ccd2 string,
ccd3 string,
ccd4 string,
ccd5 string,
ccd6 string,
ccd7 string,
ccd8 string,
ccd9 string,
ccd10 string,
call_ts1 string,
call_ts2 string,
call_ts3 string,
call_ts4 string,
call_ts5 string,
call_ts6 string,
call_ts7 string,
call_ts8 string,
call_ts9 string,
call_ts10 string,
ivr_call_id1 string,
ivr_call_id2 string,
ivr_call_id3 string,
ivr_call_id4 string,
ivr_call_id5 string,
ivr_call_id6 string,
ivr_call_id7 string,
ivr_call_id8 string,
ivr_call_id9 string,
ivr_call_id10 string,
country_cd_combo string,
prev_tvl_count int,
prev_call_count bigint,
MSG_DATE date,
MSG_TIMESTAMP string,
TOPIC string,
ALERT_TYPE  string,
primary_topic string,
secondary_topic string,
primary1_topic string,
secondary1_topic string,
primary2_topic string,
secondary2_topic string,
primary3_topic string,
secondary3_topic string,
primary4_topic string,
secondary4_topic string,
primary5_topic string,
secondary5_topic string,
primary6_topic string,
secondary6_topic string,
primary7_topic string,
secondary7_topic string,
primary8_topic string,
secondary8_topic string,
primary9_topic string,
secondary9_topic string,
primary10_topic string,
secondary10_topic string,
mvo_activate_tp_ind int,
mvo_intl_billing_ind int,	
mvo_tripplanner_ind int,	
mvo_cruise_ind int,
mvo_tp_video_ind int,	
mvo_usage_ind int,	
mvo_faq_international_ind int,	
mvo_device_support_ind int,
mvo_faq_general_ind int,
mvo_faq_outsideus_ind int,	
mvo_tp_page_chat_tp_ind int,	
mvo_settings_ind int,	
mvo_can_mex_ind int,	
mvo_unlimitedplans_ind int,	
mvo_tp_enquiry_ind int,
mvo_last_pg_vst_time string,
lst_session_activate_tp_ind int,
lst_session_billing_ind int,
lst_session_tripplanner_ind int,
lst_session_cruise_ind int,
lst_session_tp_video_vstd_ind int,
lst_session_usage_ind int,
lst_session_faq_international_ind int,
lst_session_device_support_ind int,	
lst_session_faq_general_ind int,	
lst_session_faq_outsideus_ind int,	
lst_session_tp_page_chat_tp_search_ind int,
lst_session_settings_ind int,
lst_session_can_mex_ind int,
lst_session_unlimitedplan_ind int,
lst_session_tp_enquiry_ind int,
lst_session_faq_prepaid_ind int,
mva_activate_tp_ind int,
mva_intl_billing_ind int,	
mva_cruise_ind int,
mva_usage_ind int,	
mva_device_support_ind int,	
mva_tp_page_chat_tp_ind int,	
mva_can_mex_ind int,
mva_tp_enquiry_ind int,	
mva_countries_ind int,	
mva_disable_tp_ind int,	
mva_devices_ind int,
mva_last_pg_vst_time string,	
lst_session_mfapp_activate_tp_ind int,	
lst_session_mfapp_billing_ind int,
lst_session_mfapp_cruise_ind int,	
lst_session_mfapp_usage_ind int,
lst_session_mfapp_support_ind int,	
lst_session_mfapp_tp_page_chat_tp_ind int,	
lst_session_mfapp_can_mex_ind int,
lst_session_mfapp_tp_enquiry_ind int,
lst_session_mfapp_countries_ind int,	
lst_session_mfapp_disable_tp_ind int
)
COMMENT 'International Callers base table v5'
PARTITIONED BY (Process_dt STRING)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY ','
STORED AS ORC
LOCATION '/projects/vzw_soi/db/vzw_soi_prd_tbls.db/vzsoi_intl_call_base_tbl_v5/';
